# Mann-Whitney检验

**Mann-Whitney检验**（又称为Mann-Whitney U检验或Wilcoxon秩和检验）是一种非参数统计检验方法，用于比较两个独立样本的分布是否存在显著差异。它适用于不满足正态性假设的情况。

------------------------------------------------------------------------

## **1. 检验的背景**

Mann-Whitney检验的主要目的是比较两个组的中位数或分布，尤其在样本量较小或数据不符合正态分布时。该检验通过对数据进行排序来评估两个组之间的差异。

------------------------------------------------------------------------

## **2. 假设条件**

进行Mann-Whitney检验时，需要满足以下假设条件：

1.  **独立性**：两个样本应相互独立。

2.  **秩次数据**：数据应为有序的，可以使用秩次来进行比较。

3.  **分布形状**：两组数据的分布应具有相同的形状。

------------------------------------------------------------------------

## **3. 检验统计量**

Mann-Whitney U检验的统计量U的计算公式为： $$
U = R_1 - \frac{n_1(n_1 + 1)}{2}
$$

其中：

-   $R_1$ 是组1的秩和。
-   $n_1$ 是组1的样本大小。

同时可以计算U的另一个统计量：

$$
U = n_1 n_2 - U_2
$$ 其中 $U_2$ 是组2的秩和计算得出的U值。

最终检验的结果是通过U值来判断是否拒绝原假设。

------------------------------------------------------------------------

## **4. 结果解释**

-   如果计算得出的U值小于临界值，则拒绝原假设，认为两个组之间存在显著差异。
-   如果U值大于临界值，则不能拒绝原假设，认为两个组之间没有显著差异。

------------------------------------------------------------------------

## **5. 示例：R语言中的Mann-Whitney检验**

假设我们要比较两种药物对患者血压的影响，使用R语言进行Mann-Whitney检验：

```{r}
# 创建数据
drug_A <- c(120, 130, 125, 140, 135)
drug_B <- c(150, 145, 160, 155, 170)

# 进行Mann-Whitney检验
wilcox.test(drug_A, drug_B)
```

解释：

-   w = 0, p = 0.007937

-   因为p值小于0.05，可以拒绝原假设，认为两种药物对血压的影响存在显著差异。

------------------------------------------------------------------------

## **6. 优缺点**

### 优点：

-   不要求数据服从正态分布，适用于非参数数据。
-   对小样本数据和异常值不敏感。

### 缺点：

-   只能比较两个组，无法处理多个组的比较。
-   对于秩次数据，可能失去一些信息，尤其是在分布相似的情况下。

------------------------------------------------------------------------

## **7. 总结**

Mann-Whitney检验是一种有效的非参数检验方法，适用于比较两个独立样本的差异。它能够帮助研究人员在不满足正态性假设的情况下进行有效的统计推断，但在使用时需确保满足假设条件，以保证结果的可靠性。

------------------------------------------------------------------------
